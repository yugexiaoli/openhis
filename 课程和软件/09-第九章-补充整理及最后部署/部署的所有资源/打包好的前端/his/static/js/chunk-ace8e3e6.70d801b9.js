(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ace8e3e6"],{"10dd":function(e,t,a){"use strict";var i=a("1513"),r=a.n(i);r.a},1513:function(e,t,a){},a2da:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return n})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return o})),a.d(t,"f",(function(){return c}));var i=a("b775");function r(e){return Object(i["a"])({url:"/erp/medicines/listMedicinesForPage",method:"get",params:e})}function n(e){return Object(i["a"])({url:"/erp/medicines/addMedicines",method:"post",params:e})}function s(e){return Object(i["a"])({url:"/erp/medicines/updateMedicines",method:"put",params:e})}function l(e){return Object(i["a"])({url:"/erp/medicines/deleteMedicinesByIds/"+e,method:"delete"})}function o(e){return Object(i["a"])({url:"/erp/medicines/getMedicinesById/"+e,method:"get"})}function c(e,t){return Object(i["a"])({url:"/erp/medicines/updateMedicinesStorage/"+e+"/"+t,method:"post"})}},d6e4:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"app-container"},[a("el-card",{staticStyle:{"margin-bottom":"5px","text-align":"center"}},[a("el-radio-group",{on:{change:e.schedulingTypeChange},model:{value:e.schedulingType,callback:function(t){e.schedulingType=t},expression:"schedulingType"}},e._l(e.schedulingTypeOptions,(function(t){return a("el-radio-button",{key:t.dictValue,attrs:{label:t.dictValue,value:t.dictValue}},[e._v("\n        "+e._s(t.dictLabel)+"\n      ")])})),1)],1),e._v(" "),a("el-row",{attrs:{gutter:5}},[a("el-col",{attrs:{span:7}},[a("el-card",[a("el-form",{ref:"form",attrs:{model:e.patientAllObj.patientObj,inline:!0,"label-width":"88px"}},[a("el-form-item",{attrs:{label:"患者姓名",prop:"name"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入患者姓名",disabled:!0,size:"small"},model:{value:e.patientAllObj.patientObj.name,callback:function(t){e.$set(e.patientAllObj.patientObj,"name",t)},expression:"patientAllObj.patientObj.name"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-user-solid"},on:{click:e.viewRegistration},slot:"append"})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"身份证号",prop:"idCard"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入身份证号",disabled:!0,size:"small"},model:{value:e.patientAllObj.patientObj.idCard,callback:function(t){e.$set(e.patientAllObj.patientObj,"idCard",t)},expression:"patientAllObj.patientObj.idCard"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"患者电话",prop:"phone"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入患者电话",disabled:!0,size:"small"},model:{value:e.patientAllObj.patientObj.phone,callback:function(t){e.$set(e.patientAllObj.patientObj,"phone",t)},expression:"patientAllObj.patientObj.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别",prop:"sex"}},[a("el-radio-group",{model:{value:e.patientAllObj.patientObj.sex,callback:function(t){e.$set(e.patientAllObj.patientObj,"sex",t)},expression:"patientAllObj.patientObj.sex"}},e._l(e.sexOptions,(function(t){return a("el-radio",{key:t.dictValue,attrs:{label:t.dictValue,value:t.dictValue}},[e._v(e._s(t.dictLabel))])})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"出生日期",prop:"phone"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择出生日期",disabled:!0,size:"small"},model:{value:e.patientAllObj.patientObj.birthday,callback:function(t){e.$set(e.patientAllObj.patientObj,"birthday",t)},expression:"patientAllObj.patientObj.birthday"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"患者年龄",prop:"age"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入患者年龄",disabled:!0,size:"small"},model:{value:e.patientAllObj.patientObj.age,callback:function(t){e.$set(e.patientAllObj.patientObj,"age",t)},expression:"patientAllObj.patientObj.age"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"患者地址",prop:"address"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入患者地址",disabled:!0,size:"small"},model:{value:e.patientAllObj.patientObj.address,callback:function(t){e.$set(e.patientAllObj.patientObj,"address",t)},expression:"patientAllObj.patientObj.address"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"过敏信息",prop:"allergyInfo"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入过敏信息",type:"textarea",autosize:{minRows:2,maxRows:4},disabled:!0,maxlength:"100","show-word-limit":"",size:"small"},model:{value:e.patientAllObj.patientObj.allergyInfo,callback:function(t){e.$set(e.patientAllObj.patientObj,"allergyInfo",t)},expression:"patientAllObj.patientObj.allergyInfo"}})],1)],1),e._v(" "),a("el-tabs",{attrs:{stretch:!0,type:"card"}},[a("el-tab-pane",{attrs:{label:"患者档案"}},["1"===e.patientAllObj.patientObj.isFinal?a("div",[a("div",{staticClass:"item"},[e._v("\n                紧急联系人:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.emergencyContactName)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                紧急联系人电话:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.emergencyContactPhone)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                关系: "),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.emergencyContactRelation)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                左耳听力:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.leftEarHearing)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                右耳听力:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.rightEarHearing)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                左眼视力:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.leftVision)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                右眼视力:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.rightVision)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                身高:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.height)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                体重:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.weight)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                血型:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.bloodType)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                个人史:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.personalInfo)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                家族史:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.familyInfo)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                档案创建时间:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.createTime)}})]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                档案更新时间:"),a("span",{domProps:{textContent:e._s(e.patientAllObj.patientFileObj.updateTime)}})])]):a("div",{staticStyle:{"text-align":"center"}},[e._v("\n              暂无患者档案信息\n            ")])]),e._v(" "),a("el-tab-pane",{attrs:{label:"历史病历"}},[e.patientAllObj.careHistoryObjList.length>0?a("div",[a("el-collapse",{attrs:{accordion:""}},e._l(e.patientAllObj.careHistoryObjList,(function(t,i){return a("el-collapse-item",{key:i},[a("template",{slot:"title"},[e._v("\n                    就诊部门:【"+e._s(t.deptName)+"】 就诊时间:"+e._s(t.careDate)+"\n                  ")]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                    主诉:"+e._s(t.caseTitle)+"\n                  ")]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                    发病日期:"+e._s(t.caseDate)+"\n                  ")]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                    诊断信息:"+e._s(t.caseResult)+"\n                  ")]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                    医生建议:"+e._s(t.doctorTips)+"\n                  ")]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                    备注:"+e._s(t.remark)+"\n                  ")]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                    接诊类型:"+e._s("0"===t.receiveType?"初诊":"复诊")+"\n                  ")]),e._v(" "),a("div",{staticClass:"item"},[e._v("\n                    是否传染:"+e._s("0"===t.isContagious?"否":"是")+"\n                  ")])],2)})),1)],1):a("div",{staticStyle:{"text-align":"center"}},[e._v("\n              暂无患者病历信息\n            ")])])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:17}},[a("el-card",[a("el-row",{attrs:{gutter:5}},[a("el-col",{attrs:{span:12}},[e._v("\n            挂号单号:\n            "),void 0===e.careHistory.regId?a("span",{staticStyle:{color:"red"}},[e._v("选择患者后显示")]):a("span",{staticStyle:{color:"red"}},[e._v(e._s(e.careHistory.regId))]),e._v(" "),a("br"),e._v("\n            病历编号:\n            "),void 0===e.careHistory.chId?a("span",{staticStyle:{color:"red"}},[e._v("保存病例后显示")]):a("span",{staticStyle:{color:"blue"}},[e._v(e._s(e.careHistory.chId))])]),e._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[a("el-button",{attrs:{type:"primary",disabled:void 0===e.careHistory.regId,icon:"el-icon-check"},on:{click:e.handleSaveCareHistory}},[e._v("保存病历")]),e._v(" "),a("el-button",{attrs:{type:"danger",disabled:void 0===e.careHistory.regId,icon:"el-icon-finished"},on:{click:e.handleVisitComplete}},[e._v("完成就诊")])],1)],1)],1),e._v(" "),a("el-card",{staticStyle:{"margin-top":"3px"}},[a("el-tabs",{attrs:{"v-model":e.careActiveName,type:"card"}},[a("el-tab-pane",{attrs:{label:"病历"}},[a("el-card",[a("el-form",{ref:"form",attrs:{model:e.careHistory,inline:!0,"label-width":"88px"}},[a("el-form-item",{attrs:{label:"发病日期",prop:"caseDateObj"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",size:"small"},model:{value:e.caseDateObj,callback:function(t){e.caseDateObj=t},expression:"caseDateObj"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"接诊类型",prop:"receiveType"}},[a("el-select",{attrs:{placeholder:"接诊类型",size:"small"},model:{value:e.careHistory.receiveType,callback:function(t){e.$set(e.careHistory,"receiveType",t)},expression:"careHistory.receiveType"}},e._l(e.receiveTypeOptions,(function(e){return a("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"是否传染",prop:"isContagious"}},[a("el-select",{attrs:{placeholder:"是否传染",size:"small"},model:{value:e.careHistory.isContagious,callback:function(t){e.$set(e.careHistory,"isContagious",t)},expression:"careHistory.isContagious"}},e._l(e.isContagiousOptions,(function(e){return a("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)],1)],1),e._v(" "),a("el-form",{ref:"form",attrs:{model:e.careHistory,"label-width":"88px"}},[a("el-form-item",{attrs:{label:"主诉",inline:!1,prop:"caseTitle"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:"请输入主诉",maxlength:"200","show-word-limit":"",size:"small"},model:{value:e.careHistory.caseTitle,callback:function(t){e.$set(e.careHistory,"caseTitle",t)},expression:"careHistory.caseTitle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"诊断信息",inline:!1,prop:"caseResult"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:"请输入诊断信息",maxlength:"200","show-word-limit":"",size:"small"},model:{value:e.careHistory.caseResult,callback:function(t){e.$set(e.careHistory,"caseResult",t)},expression:"careHistory.caseResult"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"医生建议",inline:!1,prop:"doctorTips"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:"请输入医生建议",maxlength:"200","show-word-limit":"",size:"small"},model:{value:e.careHistory.doctorTips,callback:function(t){e.$set(e.careHistory,"doctorTips",t)},expression:"careHistory.doctorTips"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",inline:!1,prop:"remark"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:"请输入备注",maxlength:"200","show-word-limit":"",size:"small"},model:{value:e.careHistory.remark,callback:function(t){e.$set(e.careHistory,"remark",t)},expression:"careHistory.remark"}})],1)],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"处方"}},[e.careOrders.length>0?a("el-collapse",{attrs:{accordion:""}},e._l(e.careOrders,(function(t,i){return a("el-collapse-item",{key:i},[a("template",{slot:"title"},[e._v("\n                  【"+e._s("0"===t.careOrder.coType?"药用处方":"检查处方")+"】【"+e._s(i+1)+"】【处方总额】:￥"+e._s(t.careOrder.allAmount)+"\n                ")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",data:t.careOrderItems}},[a("el-table-column",{attrs:{label:"序号",align:"center",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"0"===t.careOrder.coType?"药品名称":"项目名称",align:"center",prop:"itemName"}}),e._v(" "),a("el-table-column",{attrs:{label:"数量",align:"center",prop:"num"}}),e._v(" "),a("el-table-column",{attrs:{label:"单价(元)",align:"center",prop:"price"}}),e._v(" "),a("el-table-column",{attrs:{label:"金额(元)",align:"center",prop:"amount"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",align:"center",prop:"remark"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center",prop:"status",formatter:e.orderDetailsStatusFormatter}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"0"===t.row.status,expression:"scope.row.status==='0'"}],attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.handleCareOrderItemDeleteByItemId(t.row)}}},[e._v("删除")])]}}],null,!0)})],1)],2)})),1):e._e(),e._v(" "),a("div",{staticStyle:{margin:"3px","text-align":"left"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-plus",disabled:void 0===e.careHistory.chId},on:{click:e.handelAddMedicinesOrder}},[e._v("添加药用处方")]),e._v(" "),a("el-button",{attrs:{type:"success",icon:"el-icon-plus",disabled:void 0===e.careHistory.chId},on:{click:e.handelAddCheckItemOrder}},[e._v("添加检查处方")])],1)],1)],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"请选择挂号患者",visible:e.openRegistration,width:"1000px",center:"","close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){e.openRegistration=t}}},[a("el-tabs",{attrs:{stretch:!0,type:"card"},on:{"tab-click":e.handleRegistrationTabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待就诊列表",name:"t1"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{border:"",data:e.toBeSeenRegistration}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"right",inline:""}},[a("el-form-item",{attrs:{label:"挂号ID"}},[a("span",[e._v(e._s(t.row.regId))])]),e._v(" "),a("el-form-item",{attrs:{label:"患者ID"}},[a("span",[e._v(e._s(t.row.patientId))])]),e._v(" "),a("el-form-item",{attrs:{label:"挂号员"}},[a("span",[e._v(e._s(t.row.createBy))])]),e._v(" "),a("el-form-item",{attrs:{label:"挂号时间"}},[a("span",[e._v(e._s(t.row.createTime))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"患者姓名",align:"center",prop:"patientName"}}),e._v(" "),a("el-table-column",{attrs:{label:"流水编号",align:"center",prop:"regNumber"}}),e._v(" "),a("el-table-column",{attrs:{label:"挂号类型",align:"center",prop:"schedulingType",formatter:e.schedulingTypeFormatter}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",icon:"el-icon-check",size:"mini"},on:{click:function(a){return e.handleVisit(t.row)}}},[e._v("接诊")])]}}])})],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"就诊中列表",name:"t2"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{border:"",data:e.visitingRegistration}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"right",inline:""}},[a("el-form-item",{attrs:{label:"挂号ID"}},[a("span",[e._v(e._s(t.row.regId))])]),e._v(" "),a("el-form-item",{attrs:{label:"患者ID"}},[a("span",[e._v(e._s(t.row.patientId))])]),e._v(" "),a("el-form-item",{attrs:{label:"挂号员"}},[a("span",[e._v(e._s(t.row.createBy))])]),e._v(" "),a("el-form-item",{attrs:{label:"挂号时间"}},[a("span",[e._v(e._s(t.row.createTime))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"患者姓名",align:"center",prop:"patientName"}}),e._v(" "),a("el-table-column",{attrs:{label:"流水编号",align:"center",prop:"regNumber"}}),e._v(" "),a("el-table-column",{attrs:{label:"挂号类型",align:"center",prop:"schedulingType",formatter:e.schedulingTypeFormatter}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",icon:"el-icon-check",size:"mini"},on:{click:function(a){return e.handleLoading(t.row)}}},[e._v("载入")])]}}])})],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"就诊完成列表",name:"t3"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{border:"",data:e.visitCompletedRegistration}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"right",inline:""}},[a("el-form-item",{attrs:{label:"挂号ID"}},[a("span",[e._v(e._s(t.row.regId))])]),e._v(" "),a("el-form-item",{attrs:{label:"患者ID"}},[a("span",[e._v(e._s(t.row.patientId))])]),e._v(" "),a("el-form-item",{attrs:{label:"挂号员"}},[a("span",[e._v(e._s(t.row.createBy))])]),e._v(" "),a("el-form-item",{attrs:{label:"挂号时间"}},[a("span",[e._v(e._s(t.row.createTime))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"患者姓名",align:"center",prop:"patientName"}}),e._v(" "),a("el-table-column",{attrs:{label:"流水编号",align:"center",prop:"regNumber"}}),e._v(" "),a("el-table-column",{attrs:{label:"挂号类型",align:"center",prop:"schedulingType",formatter:e.schedulingTypeFormatter}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",icon:"el-icon-check",size:"mini"},on:{click:function(a){return e.handleLoading(t.row)}}},[e._v("载入")])]}}])})],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.openAddOrderItem,width:"1000px",center:"","close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){e.openAddOrderItem=t}}},[a("div",{staticStyle:{margin:"3px","text-align":"right"}},[e._v("\n      【"+e._s("0"===e.submitCareOrder.careOrder.coType?"药用":"检查")+"】处方总额:￥"),a("span",{staticStyle:{color:"red"}},[e._v(e._s(e.submitCareOrder.careOrder.allAmount))]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"success",icon:"el-icon-plus",disabled:0===e.submitCareOrder.careOrderItems.length},on:{click:e.handleSaveOrderItem}},[e._v("确定添加")])],1),e._v(" "),a("el-table",{attrs:{border:"",data:e.submitCareOrder.careOrderItems,"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{label:"序号",align:"center",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"0"===e.submitCareOrder.careOrder.coType?"药品名称":"项目名称",align:"center",prop:"itemName"}}),e._v(" "),a("el-table-column",{attrs:{label:"数量",width:"180px",align:"center",prop:"num"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{attrs:{size:"small"},on:{change:function(a){return e.handleCareOrderItemNumChange(t.row)}},model:{value:t.row.num,callback:function(a){e.$set(t.row,"num",a)},expression:"scope.row.num"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"单价(元)",align:"center",prop:"price"}}),e._v(" "),a("el-table-column",{attrs:{label:"金额(元)",align:"center",prop:"amount"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",align:"center",prop:"remark"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"small"},model:{value:t.row.remark,callback:function(a){e.$set(t.row,"remark",a)},expression:"scope.row.remark"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.handleCareOrderItemDelete(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-button",{staticStyle:{width:"100%","margin-top":"2px"},attrs:{type:"primary",size:"mini"},on:{click:e.handleOpenAddOrderItemDrawer}},[e._v("添加【"+e._s("0"===e.submitCareOrder.careOrder.coType?"药品":"检查")+"】项 ")])],1),e._v(" "),a("el-drawer",{attrs:{visible:e.openDrawerMedicines,direction:"rtl","append-to-body":""},on:{"update:visible":function(t){e.openDrawerMedicines=t}}},[a("h2",{attrs:{align:"center"}},[e._v("药品列表")]),e._v(" "),a("el-form",{ref:"queryItemForm",attrs:{model:e.queryItemFormParams,"label-width":"68px"}},[a("el-form-item",{attrs:{label:"关键字",prop:"keywords"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入关键字",clearable:"",size:"small"},model:{value:e.queryItemFormParams.keywords,callback:function(t){e.$set(e.queryItemFormParams,"keywords",t)},expression:"queryItemFormParams.keywords"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleMedicinesFormQuery}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",size:"mini"},on:{click:e.resetItemFormQuery}},[e._v("重置")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.drawerLoading,expression:"drawerLoading"}],attrs:{height:"600px",border:"",data:e.tableItemList},on:{"selection-change":e.handleMedicinesSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"药品ID",align:"center",prop:"medicinesId"}}),e._v(" "),a("el-table-column",{attrs:{label:"药品名称",align:"center",prop:"medicinesName"}}),e._v(" "),a("el-table-column",{attrs:{label:"关键字",align:"center",prop:"keywords"}}),e._v(" "),a("el-table-column",{attrs:{label:"库存量",align:"center",prop:"medicinesStockNum"}}),e._v(" "),a("el-table-column",{attrs:{label:"单位",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.conversion)+"/ "+e._s(t.row.unit)+"\n          ")]}}])})],1),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{"current-page":e.queryItemFormParams.pageNum,"page-sizes":[5,10,20,30],"page-size":e.queryItemFormParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleMedicinesSizeChange,"current-change":e.handleMedicinesCurrentChange}}),e._v(" "),a("el-form-item",[a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"mini"},on:{click:e.hanldeAddCareItem}},[e._v("添加并关闭")])],1)])],1)],1),e._v(" "),a("el-drawer",{attrs:{visible:e.openDrawerCheckItem,direction:"rtl","append-to-body":""},on:{"update:visible":function(t){e.openDrawerCheckItem=t}}},[a("h2",{attrs:{align:"center"}},[e._v("检查项目列表")]),e._v(" "),a("el-form",{ref:"queryItemForm",attrs:{model:e.queryItemFormParams,"label-width":"68px"}},[a("el-form-item",{attrs:{label:"关键字",prop:"keywords"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入关键字",clearable:"",size:"small"},model:{value:e.queryItemFormParams.keywords,callback:function(t){e.$set(e.queryItemFormParams,"keywords",t)},expression:"queryItemFormParams.keywords"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleCheckItemFormQuery}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",size:"mini"},on:{click:e.resetItemFormQuery}},[e._v("重置")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.drawerLoading,expression:"drawerLoading"}],attrs:{height:"600px",border:"",data:e.tableItemList},on:{"selection-change":e.handleCheckItemSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"项目ID",align:"center",prop:"checkItemId"}}),e._v(" "),a("el-table-column",{attrs:{label:"项目名称",align:"center",prop:"checkItemName"}}),e._v(" "),a("el-table-column",{attrs:{label:"关键字",align:"center",prop:"keywords"}}),e._v(" "),a("el-table-column",{attrs:{label:"项目单价",align:"center",prop:"unitPrice"}}),e._v(" "),a("el-table-column",{attrs:{label:"单位",align:"center",prop:"unit"}})],1),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{"current-page":e.queryItemFormParams.pageNum,"page-sizes":[5,10,20,30],"page-size":e.queryItemFormParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleCheckItemSizeChange,"current-change":e.handleCheckItemCurrentChange}}),e._v(" "),a("el-form-item",[a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"mini"},on:{click:e.hanldeAddCareItem}},[e._v("添加并关闭")])],1)])],1)],1)],1)},r=[],n=(a("7f7f"),a("b775"));function s(e){return Object(n["a"])({url:"/doctor/care/queryToBeSeenRegistration/"+e,method:"get"})}function l(e){return Object(n["a"])({url:"/doctor/care/queryVisitingRegistration/"+e,method:"get"})}function o(e){return Object(n["a"])({url:"/doctor/care/queryVisitCompletedRegistration/"+e,method:"get"})}function c(e){return Object(n["a"])({url:"/doctor/care/receivePatient/"+e,method:"post"})}function d(e){return Object(n["a"])({url:"/doctor/care/getPatientAllMessageByPatientId/"+e,method:"get"})}function m(e){return Object(n["a"])({url:"/doctor/care/saveCareHistory",method:"post",data:e})}function p(e){return Object(n["a"])({url:"/doctor/care/getCareHistoryByRegId/"+e,method:"get"})}function u(e){return Object(n["a"])({url:"/doctor/care/queryCareOrdersByChId/"+e,method:"get"})}function h(e){return Object(n["a"])({url:"/doctor/care/saveCareOrderItem",method:"post",data:e})}function b(e){return Object(n["a"])({url:"/doctor/care/deleteCareOrderItemById/"+e,method:"delete"})}function g(e){return Object(n["a"])({url:"/doctor/care/visitComplete/"+e,method:"post"})}var v=a("f7cb"),y=a("a2da"),f={data:function(){return{loading:!1,tableLoading:!1,schedulingType:"1",schedulingTypeOptions:[],subsectionTypeOptions:[],sexOptions:[],receiveTypeOptions:[],isContagiousOptions:[],orderDetailsStatusOptions:[],openRegistration:!1,activeName:"t1",careActiveName:"c1",toBeSeenRegistration:[],visitingRegistration:[],visitCompletedRegistration:[],caseDateObj:new Date,patientAllObj:{patientObj:{},patientFileObj:{},careHistoryObjList:[]},careHistory:{regId:void 0,chId:void 0,caseDate:void 0,receiveType:"0",isContagious:"0",caseTitle:void 0,caseResult:void 0,doctorTips:void 0,remark:void 0,patientId:void 0,patientName:void 0},careOrders:[],submitCareOrder:{careOrder:{allAmount:0,patientId:void 0,patientName:void 0,coType:"0"},careOrderItems:[]},title:"",openAddOrderItem:!1,openDrawerMedicines:!1,openDrawerCheckItem:!1,queryItemFormParams:{pageNum:1,pageSize:10,keywords:void 0},tableItemList:[],total:0,drawerLoading:!1,selectItemList:[]}},created:function(){var e=this;this.getDataByType("his_scheduling_type").then((function(t){e.schedulingTypeOptions=t.data})),this.getDataByType("his_subsection_type").then((function(t){e.subsectionTypeOptions=t.data})),this.getDataByType("sys_user_sex").then((function(t){e.sexOptions=t.data})),this.getDataByType("his_receive_type").then((function(t){e.receiveTypeOptions=t.data})),this.getDataByType("his_contagious_status").then((function(t){e.isContagiousOptions=t.data})),this.getDataByType("his_order_details_status").then((function(t){e.orderDetailsStatusOptions=t.data}))},methods:{schedulingTypeChange:function(e){this.schedulingType=e},viewRegistration:function(){this.activeName="t1",this.openRegistration=!0,this.queryToBeSeenRegistration()},handleRegistrationTabClick:function(e,t){"t1"===e.name?this.queryToBeSeenRegistration():"t2"===e.name?this.queryVisitingRegistration():"t3"===e.name&&this.queryVisitCompletedRegistration()},queryToBeSeenRegistration:function(){var e=this;this.tableLoading=!0,s(this.schedulingType).then((function(t){e.toBeSeenRegistration=t.data,e.tableLoading=!1})).catch((function(){e.msgError("查询失败"),e.tableLoading=!1}))},queryVisitingRegistration:function(){var e=this;this.tableLoading=!0,l(this.schedulingType).then((function(t){e.visitingRegistration=t.data,e.tableLoading=!1})).catch((function(){e.msgError("查询失败"),e.tableLoading=!1}))},queryVisitCompletedRegistration:function(){var e=this;this.tableLoading=!0,o(this.schedulingType).then((function(t){e.visitCompletedRegistration=t.data,e.tableLoading=!1})).catch((function(){e.msgError("查询失败"),e.tableLoading=!1}))},schedulingTypeFormatter:function(e){return this.selectDictLabel(this.schedulingTypeOptions,e.schedulingType)},orderDetailsStatusFormatter:function(e){return this.selectDictLabel(this.orderDetailsStatusOptions,e.status)},handleVisit:function(e){var t=this;this.careHistory.regId=e.regId;var a=e.patientId;this.loading=!0,c(this.careHistory.regId).then((function(e){t.loading=!1,t.msgSuccess("接诊成功"),d(a).then((function(e){t.patientAllObj.patientObj=e.data.patient,t.patientAllObj.patientObj.age=t.getAge(e.data.patient.birthday),t.patientAllObj.patientFileObj=e.data.patientFile,t.patientAllObj.careHistoryObjList=e.data.careHistoryList,t.openRegistration=!1,t.loading=!1})).catch((function(){t.msgError("查询患者信息失败"),t.loading=!1}))})).catch((function(){t.msgError("接诊失败"),t.loading=!1}))},handleLoading:function(e){var t=this;this.careHistory.regId=e.regId;var a=e.patientId;d(a).then((function(e){t.patientAllObj.patientObj=e.data.patient,t.patientAllObj.patientObj.age=t.getAge(e.data.patient.birthday),t.patientAllObj.patientFileObj=e.data.patientFile,t.patientAllObj.careHistoryObjList=e.data.careHistoryList,t.openRegistration=!1,t.loading=!1})).catch((function(){t.msgError("载入失败"),t.loading=!1})),this.getCareHistoryByRegId(e.regId)},getCareHistoryByRegId:function(e){var t=this;this.loading=!0,p(e).then((function(a){null!=a.data?(t.careHistory=a.data,t.caseDateObj=a.data.careDate,t.getCareOrdersByChId(a.data.chId)):t.resetCareHistoryAndCareOrders(e),t.loading=!1})).catch((function(){t.msgError("查询病历失败"),t.loading=!1}))},getCareOrdersByChId:function(e){var t=this;this.loading=!0,u(e).then((function(e){t.careOrders=e.data,t.loading=!1})).catch((function(){t.msgError("查询详情失败"),t.loading=!1}))},resetCareHistoryAndCareOrders:function(e){this.careHistory={regId:e,chId:void 0,caseDate:void 0,caseDateObj:new Date,receiveType:"0",isContagious:"0",caseTitle:void 0,caseResult:void 0,doctorTips:void 0,remark:void 0,patientId:void 0,patientName:void 0},this.careOrders=[]},handleSaveCareHistory:function(){var e=this;this.careHistory.regId?(this.careHistory.caseDate=this.moment(this.caseDateObj).format("YYYY-MM-DD"),this.careHistory.patientId=this.patientAllObj.patientObj.patientId,this.careHistory.patientName=this.patientAllObj.patientObj.name,this.loading=!0,m(this.careHistory).then((function(t){e.msgSuccess("保存病历成功"),e.loading=!1,e.careHistory.chId=t.data.chId})).catch((function(){e.msgError("保存病历失败"),e.loading=!1}))):this.msgError("请选择挂号患者")},handelAddMedicinesOrder:function(){this.careHistory.regId?this.careHistory.chId?(this.submitCareOrder.careOrder.coType="0",this.title="添加【药用】处方",this.openAddOrderItem=!0,this.submitCareOrder.careOrderItems=[]):this.msgError("请先保存病历"):this.msgError("请选择挂号患者")},handelAddCheckItemOrder:function(){this.careHistory.regId?this.careHistory.chId?(this.submitCareOrder.careOrder.coType="1",this.title="添加【检查】处方",this.openAddOrderItem=!0,this.submitCareOrder.careOrderItems=[]):this.msgError("请先保存病历"):this.msgError("请选择挂号患者")},handleOpenAddOrderItemDrawer:function(){"0"===this.submitCareOrder.careOrder.coType?(this.openDrawerMedicines=!0,this.resetItemFormQuery(),this.getMedicinesList()):(this.openDrawerCheckItem=!0,this.resetItemFormQuery(),this.getCheckItemList())},getMedicinesList:function(){var e=this;this.tableItemList=[],this.drawerLoading=!0,Object(y["d"])(this.queryItemFormParams).then((function(t){e.tableItemList=t.data,e.total=t.total,e.drawerLoading=!1})).catch((function(){e.drawerLoading=!1,e.msgError("查询药品失败")}))},handleMedicinesSelectionChange:function(e){this.selectItemList=e},handleMedicinesSizeChange:function(e){this.queryItemFormParams.pageSize=e,this.getMedicinesList()},handleMedicinesCurrentChange:function(e){this.queryItemFormParams.pageNum=e,this.getMedicinesList()},handleMedicinesFormQuery:function(){this.queryItemFormParams.pageNum=1,this.getMedicinesList()},getCheckItemList:function(){var e=this;this.tableItemList=[],this.drawerLoading=!0,Object(v["d"])(this.queryItemFormParams).then((function(t){e.tableItemList=t.data,e.total=t.total,e.drawerLoading=!1})).catch((function(){e.drawerLoading=!1,e.msgError("查询检查项目失败")}))},handleCheckItemSelectionChange:function(e){this.selectItemList=e},handleCheckItemSizeChange:function(e){this.queryItemFormParams.pageSize=e,this.getCheckItemList()},handleCheckItemCurrentChange:function(e){this.queryItemFormParams.pageNum=e,this.getCheckItemList()},handleCheckItemFormQuery:function(){this.queryItemFormParams.pageNum=1,this.getCheckItemList()},resetItemFormQuery:function(){this.queryItemFormParams={pageNum:1,pageSize:10,keywords:void 0},"0"===this.submitCareOrder.careOrder.coType?this.getMedicinesList():this.getCheckItemList()},hanldeAddCareItem:function(){var e=this,t=this.submitCareOrder.careOrder.coType;0!==this.selectItemList.length?("0"===t?this.selectItemList.filter((function(a){var i={itemRefId:a.medicinesId,itemName:a.medicinesName,itemType:t,num:1,price:a.prescriptionPrice,amount:1*a.prescriptionPrice,remark:"请按说明服用"},r=!1;e.submitCareOrder.careOrderItems.filter((function(e){e.itemRefId===i.itemRefId&&(e.num=e.num+1,r=!0)})),r||e.submitCareOrder.careOrderItems.push(i),e.openDrawerMedicines=!1})):this.selectItemList.filter((function(a){var i={itemRefId:a.checkItemId,itemName:a.checkItemName,itemType:t,num:1,price:a.unitPrice,amount:1*a.unitPrice,remark:"按要求检查"},r=!1;e.submitCareOrder.careOrderItems.filter((function(e){e.itemRefId===i.itemRefId&&(e.num=e.num+1,r=!0)})),r||e.submitCareOrder.careOrderItems.push(i),e.openDrawerCheckItem=!1})),this.computeOrderItemAllAmount()):this.msgError("请选择【"+("0"===t?"药品":"检查项目")+"】")},handleCareOrderItemDelete:function(e){this.submitCareOrder.careOrderItems.splice(e.index,1),this.computeOrderItemAllAmount()},tableRowClassName:function(e){var t=e.row,a=e.rowIndex;t.index=a},computeOrderItemAllAmount:function(){var e=this;this.submitCareOrder.careOrder.allAmount=0,this.submitCareOrder.careOrderItems.filter((function(t){e.submitCareOrder.careOrder.allAmount+=t.num*t.price}))},handleCareOrderItemNumChange:function(e){e.amount=e.num*e.price,this.computeOrderItemAllAmount()},handleSaveOrderItem:function(){var e=this;0!==this.submitCareOrder.careOrderItems.length?(this.submitCareOrder.careOrder.patientId=this.careHistory.patientId,this.submitCareOrder.careOrder.patientName=this.careHistory.patientName,this.submitCareOrder.careOrder.chId=this.careHistory.chId,console.log(this.submitCareOrder),this.loading=!0,h(this.submitCareOrder).then((function(t){e.loading=!1,e.msgSuccess("保存成功"),e.getCareOrdersByChId(e.careHistory.chId),e.openAddOrderItem=!1})).catch((function(){e.msgError("保存失败"),e.loading=!1}))):this.msgError("添加处方详情")},handleCareOrderItemDeleteByItemId:function(e){var t=this,a=e.itemId,i=e.itemName,r=this;r.$confirm("是否确定删除【"+i+"】这条详情, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){b(a).then((function(e){t.msgSuccess("删除成功"),t.getCareOrdersByChId(t.careHistory.chId)})).catch((function(){t.msgError("删除失败")}))})).catch((function(){r.msgError("删除已取消"),r.loading=!1}))},handleVisitComplete:function(){var e=this,t=this.careHistory.regId,a=this.careHistory.patientName,i=this;i.$confirm("是否确定完成【"+a+"】的就诊, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){g(t).then((function(t){e.msgSuccess("操作成功"),e.resetAllData()})).catch((function(){e.msgError("操作失败")}))})).catch((function(){i.msgError("操作已取消"),i.loading=!1}))},resetAllData:function(){this.patientAllObj={patientObj:{},patientFileObj:{},careHistoryObjList:[]},this.careHistory={regId:void 0,chId:void 0,caseDate:void 0,receiveType:"0",isContagious:"0",caseTitle:void 0,caseResult:void 0,doctorTips:void 0,remark:void 0,patientId:void 0,patientName:void 0},this.careOrders=[],this.submitCareOrder={careOrder:{allAmount:0,patientId:void 0,patientName:void 0,coType:"0"},careOrderItems:[]}}}},O=f,_=(a("10dd"),a("2877")),I=Object(_["a"])(O,i,r,!1,null,"29f48ca3",null);t["default"]=I.exports},f7cb:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return n})),a.d(t,"f",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return c}));var i=a("b775");function r(e){return Object(i["a"])({url:"/system/checkItem/listCheckItemForPage",method:"get",params:e})}function n(e){return Object(i["a"])({url:"/system/checkItem/addCheckItem",method:"post",params:e})}function s(e){return Object(i["a"])({url:"/system/checkItem/updateCheckItem",method:"put",params:e})}function l(e){return Object(i["a"])({url:"/system/checkItem/deleteCheckItemByIds/"+e,method:"delete"})}function o(e){return Object(i["a"])({url:"/system/checkItem/getCheckItemById/"+e,method:"get"})}function c(){return Object(i["a"])({url:"/system/checkItem/selectAllCheckItem",method:"get"})}}}]);