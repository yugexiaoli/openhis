(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ee7798a2"],{"0393":function(e,t,l){"use strict";l.d(t,"c",(function(){return a})),l.d(t,"b",(function(){return r})),l.d(t,"d",(function(){return s})),l.d(t,"a",(function(){return i}));var n=l("b775");function a(e){return Object(n["a"])({url:"/doctor/scheduling/queryUsersNeedScheduling",params:{deptId:e}})}function r(e){return Object(n["a"])({url:"/doctor/scheduling/queryScheduling",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/doctor/scheduling/saveScheduling",method:"post",data:e})}function i(e){return Object(n["a"])({url:"/doctor/scheduling/queryMyScheduling",method:"get",params:e})}},3436:function(e,t,l){"use strict";l.r(t);var n=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"app-container"},[l("el-row",{staticStyle:{"margin-bottom":"5px"},attrs:{gutter:12}},[l("el-col",{attrs:{span:24}},[l("el-card",[l("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0,"label-width":"68px"}},[l("el-form-item",{attrs:{label:"科室名称",prop:"deptId"}},[l("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择科室名称",clearable:"",size:"small"},model:{value:e.queryParams.deptId,callback:function(t){e.$set(e.queryParams,"deptId",t)},expression:"queryParams.deptId"}},e._l(e.deptOptions,(function(e){return l("el-option",{key:e.deptId,attrs:{label:e.deptName,value:e.deptId}})})),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"医生名称",prop:"userId"}},[l("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择医生名称",clearable:"",size:"small"},model:{value:e.queryParams.userId,callback:function(t){e.$set(e.queryParams,"userId",t)},expression:"queryParams.userId"}},e._l(e.userOptions,(function(e){return l("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})})),1)],1),e._v(" "),l("el-form-item",[l("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),e._v(" "),l("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1),e._v(" "),l("el-form-item",{staticStyle:{float:"right"}},[l("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:function(t){return e.upWeek()}}},[e._v("上一周")]),e._v(" "),l("el-button",{attrs:{type:"success",icon:"el-icon-s-operation",size:"small"},on:{click:function(t){return e.currentWeek()}}},[e._v("当前周")]),e._v(" "),l("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:function(t){return e.nextWeek()}}},[e._v("下一周")])],1)],1)],1)],1)],1),e._v(" "),l("el-row",{staticStyle:{"margin-bottom":"5px"},attrs:{gutter:12}},[l("el-col",{attrs:{span:24}},[l("el-card",[l("div",{staticStyle:{"text-align":"center"}},[l("span",[e._v(e._s(e.schedulingData.startTimeThisWeek)+"(周一)")]),e._v("-"),l("span",[e._v(e._s(e.schedulingData.endTimeThisWeek)+"(周日)")])])])],1)],1),e._v(" "),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,border:"","span-method":e.spanMethod}},[l("el-table-column",{attrs:{prop:"userId",label:"医生",align:"center",formatter:e.userFormatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"deptId",label:"科室",align:"center",formatter:e.deptFormatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"subsectionType",label:"时间/日期",align:"center",formatter:e.subsectionTypeFormatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[0]",label:e.labelNames[0],align:"center",formatter:e.schedulingTypeDay1Formatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[1]",label:e.labelNames[1],align:"center",formatter:e.schedulingTypeDay2Formatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[2]",label:e.labelNames[2],align:"center",formatter:e.schedulingTypeDay3Formatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[3]",label:e.labelNames[3],align:"center",formatter:e.schedulingTypeDay4Formatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[4]",label:e.labelNames[4],align:"center",formatter:e.schedulingTypeDay5Formatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[5]",label:e.labelNames[5],align:"center",formatter:e.schedulingTypeDay6Formatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[6]",label:e.labelNames[6],align:"center",formatter:e.schedulingTypeDay7Formatter}}),e._v(" "),l("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text",icon:"el-icon-edit",size:"mini"},on:{click:function(l){return e.editScheduling(t.row.userId)}}},[e._v("编辑")])]}}])})],1),e._v(" "),l("el-dialog",{attrs:{title:e.title,visible:e.open,width:"1200px",center:"","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[l("el-table",{attrs:{data:e.editData,border:""}},[l("el-table-column",{attrs:{prop:"subsectionType",label:"时间/日期",align:"center",formatter:e.subsectionTypeFormatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[0]",label:e.labelNames[0],align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{attrs:{clearable:"",size:"small"},model:{value:t.row.schedulingType[0],callback:function(l){e.$set(t.row.schedulingType,0,l)},expression:"scope.row.schedulingType[0]"}},e._l(e.schedulingTypeOptions,(function(e){return l("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[1]",label:e.labelNames[1],align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{attrs:{clearable:"",size:"small"},model:{value:t.row.schedulingType[1],callback:function(l){e.$set(t.row.schedulingType,1,l)},expression:"scope.row.schedulingType[1]"}},e._l(e.schedulingTypeOptions,(function(e){return l("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[2]",label:e.labelNames[2],align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{attrs:{clearable:"",size:"small"},model:{value:t.row.schedulingType[2],callback:function(l){e.$set(t.row.schedulingType,2,l)},expression:"scope.row.schedulingType[2]"}},e._l(e.schedulingTypeOptions,(function(e){return l("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[3]",label:e.labelNames[3],align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{attrs:{clearable:"",size:"small"},model:{value:t.row.schedulingType[3],callback:function(l){e.$set(t.row.schedulingType,3,l)},expression:"scope.row.schedulingType[3]"}},e._l(e.schedulingTypeOptions,(function(e){return l("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[4]",label:e.labelNames[4],align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{attrs:{clearable:"",size:"small"},model:{value:t.row.schedulingType[4],callback:function(l){e.$set(t.row.schedulingType,4,l)},expression:"scope.row.schedulingType[4]"}},e._l(e.schedulingTypeOptions,(function(e){return l("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[5]",label:e.labelNames[5],align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{attrs:{clearable:"",size:"small"},model:{value:t.row.schedulingType[5],callback:function(l){e.$set(t.row.schedulingType,5,l)},expression:"scope.row.schedulingType[5]"}},e._l(e.schedulingTypeOptions,(function(e){return l("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"schedulingType[6]",label:e.labelNames[6],align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{attrs:{clearable:"",size:"small"},model:{value:t.row.schedulingType[6],callback:function(l){e.$set(t.row.schedulingType,6,l)},expression:"scope.row.schedulingType[6]"}},e._l(e.schedulingTypeOptions,(function(e){return l("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)]}}])})],1),e._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确 定")]),e._v(" "),l("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},a=[],r=(l("1c4c"),l("ac6a"),l("5df3"),l("4f7f"),l("0393")),s=l("fcb7"),i={data:function(){return{loading:!1,deptOptions:[],userOptions:[],subsectionTypeOptions:[],schedulingTypeOptions:[],queryParams:{deptId:void 0,userId:void 0,queryDate:void 0},schedulingData:{startTimeThisWeek:void 0,endTimeThisWeek:void 0},tableData:[],labelNames:["","","","","","",""],open:!1,title:"",editData:[]}},computed:{groupNum:function(){return new Set(this.tableData.map((function(e){return e.userId})))}},created:function(){var e=this;Object(s["e"])().then((function(t){e.deptOptions=t.data})),Object(r["c"])().then((function(t){e.userOptions=t.data})),this.getDataByType("his_scheduling_type").then((function(t){e.schedulingTypeOptions=t.data})),this.getDataByType("his_subsection_type").then((function(t){e.subsectionTypeOptions=t.data})),this.listScheduling()},methods:{listScheduling:function(){var e=this;this.loading=!0,Object(r["b"])(this.queryParams).then((function(t){console.log(t),e.labelNames=t.data.labelNames,e.tableData=t.data.tableData,e.schedulingData=t.data.schedulingData,e.loading=!1}))},handleQuery:function(){this.listScheduling()},resetQuery:function(){this.resetForm("queryForm"),this.listScheduling()},upWeek:function(){this.queryParams.queryDate=this.schedulingData.startTimeThisWeek,this.listScheduling()},currentWeek:function(){this.queryParams.queryDate=void 0,this.listScheduling()},nextWeek:function(){this.queryParams.queryDate=this.schedulingData.endTimeThisWeek,this.listScheduling()},userFormatter:function(e){var t="";return this.userOptions.filter((function(l){e.userId===l.userId&&(t=l.userName)})),t},deptFormatter:function(e){var t="";return this.deptOptions.filter((function(l){e.deptId===l.deptId&&(t=l.deptName)})),t},subsectionTypeFormatter:function(e){return this.selectDictLabel(this.subsectionTypeOptions,e.subsectionType)},schedulingTypeDay1Formatter:function(e){return this.selectDictLabel(this.schedulingTypeOptions,e.schedulingType[0])},schedulingTypeDay2Formatter:function(e){return this.selectDictLabel(this.schedulingTypeOptions,e.schedulingType[1])},schedulingTypeDay3Formatter:function(e){return this.selectDictLabel(this.schedulingTypeOptions,e.schedulingType[2])},schedulingTypeDay4Formatter:function(e){return this.selectDictLabel(this.schedulingTypeOptions,e.schedulingType[3])},schedulingTypeDay5Formatter:function(e){return this.selectDictLabel(this.schedulingTypeOptions,e.schedulingType[4])},schedulingTypeDay6Formatter:function(e){return this.selectDictLabel(this.schedulingTypeOptions,e.schedulingType[5])},schedulingTypeDay7Formatter:function(e){return this.selectDictLabel(this.schedulingTypeOptions,e.schedulingType[6])},spanMethod:function(e){var t=e.row,l=e.rowIndex,n=e.columnIndex;if(n<2||n>9){var a=this.userGroup(t.userId),r=this.userIdLen(t.userId);return l===r?{rowspan:a,colspan:1}:{rowspan:0,colspan:0}}return{rowspan:1,colspan:1}},userGroup:function(e){return this.tableData.filter((function(t){return t.userId===e})).length},userIdLen:function(e){for(var t=Array.from(this.groupNum),l=t.indexOf(e),n=0,a=0;a<l;a++)n+=this.userGroup(t[a]);return n},editScheduling:function(e){var t=this;this.editData=[],this.open=!0;var l="";this.userOptions.filter((function(t){e===t.userId&&(l=t.userName)})),this.title="修改【"+l+"】的排班信息",this.tableData.filter((function(l){l.userId===e&&t.editData.push(l)}))},cancel:function(){this.open=!1},handleSubmit:function(){var e=this,t={beginDate:this.schedulingData.startTimeThisWeek,data:this.editData};this.loading=!0,Object(r["d"])(t).then((function(t){e.loading=!1,e.open=!1,e.msgSuccess("保存成功")})).catch((function(){e.loading=!1,e.msgError("保存失败")}))}}},u=i,c=l("2877"),o=Object(c["a"])(u,n,a,!1,null,null,null);t["default"]=o.exports},fcb7:function(e,t,l){"use strict";l.d(t,"d",(function(){return a})),l.d(t,"a",(function(){return r})),l.d(t,"f",(function(){return s})),l.d(t,"b",(function(){return i})),l.d(t,"c",(function(){return u})),l.d(t,"e",(function(){return c}));var n=l("b775");function a(e){return Object(n["a"])({url:"/system/dept/listDeptForPage",method:"get",params:e})}function r(e){return Object(n["a"])({url:"/system/dept/addDept",method:"post",params:e})}function s(e){return Object(n["a"])({url:"/system/dept/updateDept",method:"put",params:e})}function i(e){return Object(n["a"])({url:"/system/dept/deleteDeptByIds/"+e,method:"delete"})}function u(e){return Object(n["a"])({url:"/system/dept/getDeptById/"+e,method:"get"})}function c(){return Object(n["a"])({url:"/system/dept/selectAllDept",method:"get"})}}}]);